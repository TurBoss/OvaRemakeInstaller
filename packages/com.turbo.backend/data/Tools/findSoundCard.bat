SETLOCAL ENABLEDELAYEDEXPANSION

SET N=0

SET CMD="devcon.exe hwids MMDEVAPI* | findstr SWD\\MMDEVAPI"

FOR /F "tokens=*" %%i IN (' %CMD% ') DO (
	
	SET CODE=%%i
	
	SET ID=!CODE:~31,36!
	
	SET BYTE1=!ID:~6,2!
	SET BYTE2=!ID:~4,2!
	SET BYTE3=!ID:~2,2!
	SET BYTE4=!ID:~0,2!
	
	SET BYTE5=!ID:~11,2!
	SET BYTE6=!ID:~9,2!
	
	SET BYTE7=!ID:~16,2!
	SET BYTE8=!ID:~14,2!
	
	SET BYTE9=!ID:~19,4!
	SET BYTE10=!ID:~24,12!
	
	SET GUID=!BYTE1!!BYTE2!!BYTE3!!BYTE4!!BYTE5!!BYTE6!!BYTE7!!BYTE8!!BYTE9!!BYTE10!

	REG ADD "HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Square Soft, Inc.\Final Fantasy VII\1.00\Sound" /v Sound_GUID /t REG_BINARY /d !GUID! /f
	REG ADD "HKEY_LOCAL_MACHINE\SOFTWARE\Square Soft, Inc.\Final Fantasy VII\1.00\Sound" /v Sound_GUID /t REG_BINARY /d !GUID! /f
	
	SET /A N+=1
)
